<!doctype html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <link rel="stylesheet" type="text/css" href="../../../support/css/physcomp.css" />
    <title>Exercise: Stepper Motor Knob</title>
  </head>
  <body>
    <h2>Exercise: Stepper Motor Knob</h2>
<h4>Objective</h4>
    <p>WARNING: this exercise has been known to have bugs in the circuit and the code.
       If you would like extra credit, submit a bug fix to some or all of the issues you
       find.</p>

    <p>Control a stepper motor using a driver module.</p>

    <p>A <a href="http://en.wikipedia.org/wiki/Stepper_motor">stepper motor</a>
      uses a toothed rotor and multiple drive coils to create motion in discrete
      steps.  The fundamental angular size of the steps is determined by the
      physical spacing of the internal magnetic teeth.  Steppers motors
      are <em>open-loop</em> since there is no sensor involved in controlling
      position, the driver simply cycles the coil currents and assumes the motor
      moves synchronously.  If the motor encounters too high a torque, the
      magnetic forces can be overcome and the rotor will slip to a different
      position.  The microcontroller has have no means of detecting this
      error.</p>

    <p>This exercise uses
      an <a href="http://www.allegromicro.com/~/media/Files/Datasheets/A4988-Datasheet.ashx">
      stepper motor driver</a> module which takes care of cycling the currents
      appropriately through the two coils of a bipolar stepper motor.  The
      primary inputs to the driver are <em>direction</em> and <em>step</em>.
      The additional inputs control fractional stepping and the overall driver
      power state.</p>

    <p>As a simple one-in one-out demonstration, the exercise uses a
      potentiometer as an analog position command control input.</p>

    <h4>Steps and observations</h4>
    <ol>
      <li>Use a DMM to measure the winding resistance of the stepper motor.  A
	bipolar stepper motor will have two independent windings which should be
	clearly observable as a low resistance between two separate wire
	pairs.</li>

      <li>The lab stocks several different kinds of stepper motors and stepper
	motor drivers.  Please check the motor type; it should have a rated
	voltage lower than your supply voltage.  These drivers control the
	current by chopping the power supply, so the supply voltage can be
	higher than the motor rating.  If the chosen supply voltage is less than
	8V (e.g. 2.7V), you will need to use
	the <a href="http://www.pololu.com/product/2134">low-voltage DRV8834
	stepper motor driver</a>.  If the supply voltage is more than 8V
	(e.g. 10-12V), you should use
	the <a href="http://www.pololu.com/product/1182">A4988 stepper motor
	driver</a>, which is a newer replacement for the
	<a href="http://www.allegromicro.com/~/media/Files/Datasheets/A4983-Datasheet.ashx">A4983</a>.</li>

      <li>Load and run the KnobToStepper sketch from the course materials,
	located in the same folder as this file if you have cloned the github distribution.  If not, it is
	<a href="KnobToStepperMotor/KnobToStepperMotor.ino">directly
	downloadable</a>. (Note: there is a MotorKnob
	sketch included in the Arduino IDE which assumes the stepper motor is
	directly driven from the Arduino; instead we will use a modular driver
	for this exercise.)</li>

      <li>Observe the stepper motor motion.</li>

      <li>Try moving the MS1 pull-up resistor between 5V and GND and observing
	the resulting change in step rate.  The driver is capable
	of <em>microstepping</em> in which the coils can be driven using PWM
	rather simply on or off in order to divide the fundamental step into
	smaller angles.</li>

      <li>Read the data sheet for the driver and configure the driver for even
	finer steps.</li>

    </ol>

    <h4>Comments</h4>

    <p>Stepper motors can move relatively fast but at too high a rate can lose count.</p>

    <p><em>Note: The following diagrams were tested with a polulu DRV8834 Low-Voltage Stepper Motor Driver Carrier. There may be some different versions of this, or other, stepper motor drivers from polulu in the lab. If the code in these diagrams do not work, you may need to float some of the pins high, as shown in <a href = "stepper-motor-knob_bb.png">this diagram</a> and <a href="stepper-motor-knob_schem.png">schematic</a>.</em></p>
  <img class="alignnone" src="newDiagrams/stepper-motor-knob_bb_new.jpg" />
<img class="alignnone" src="newDiagrams/stepper-motor-knob_schem_new.jpg" />
    <h4>Other Files</h4>
    <ol>
      <li><a href="stepper-motor-knob.fzz">stepper-motor-knob.fzz</a></li>
    </ol>
    <h4>Sub-Folders</h4>
    <ol>
      <li><a href="KnobToStepperMotor/index.html">KnobToStepperMotor</a></li>
    </ol>
  </body>
</html>
